{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"C:\\\\Users\\\\User\\\\Documents\\\\clone-starter-kit-08\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"C:\\\\Users\\\\User\\\\Documents\\\\clone-starter-kit-08\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/createClass\");\n\nvar _require = require('native-abort-controller'),\n    AbortController = _require.AbortController;\n\nvar SubscriptionTracker = /*#__PURE__*/function () {\n  function SubscriptionTracker() {\n    _classCallCheck(this, SubscriptionTracker);\n\n    this._subs = new Map();\n  }\n\n  _createClass(SubscriptionTracker, [{\n    key: \"subscribe\",\n    value: function subscribe(topic, handler, signal) {\n      var _this = this;\n\n      var topicSubs = this._subs.get(topic) || [];\n\n      if (topicSubs.find(function (s) {\n        return s.handler === handler;\n      })) {\n        throw new Error(\"Already subscribed to \".concat(topic, \" with this handler\"));\n      } // Create controller so a call to unsubscribe can cancel the request\n\n\n      var controller = new AbortController();\n\n      this._subs.set(topic, [{\n        handler: handler,\n        controller: controller\n      }].concat(topicSubs)); // If there is an external signal, forward the abort event\n\n\n      if (signal) {\n        signal.addEventListener('abort', function () {\n          return _this.unsubscribe(topic, handler);\n        });\n      }\n\n      return controller.signal;\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe(topic, handler) {\n      var subs = this._subs.get(topic) || [];\n      var unsubs;\n\n      if (handler) {\n        this._subs.set(topic, subs.filter(function (s) {\n          return s.handler !== handler;\n        }));\n\n        unsubs = subs.filter(function (s) {\n          return s.handler === handler;\n        });\n      } else {\n        this._subs.set(topic, []);\n\n        unsubs = subs;\n      }\n\n      unsubs.forEach(function (s) {\n        return s.controller.abort();\n      });\n    }\n  }], [{\n    key: \"singleton\",\n    value: function singleton() {\n      if (SubscriptionTracker.instance) return SubscriptionTracker.instance;\n      SubscriptionTracker.instance = new SubscriptionTracker();\n      return SubscriptionTracker.instance;\n    }\n  }]);\n\n  return SubscriptionTracker;\n}();\n\nSubscriptionTracker.instance = null;\nmodule.exports = SubscriptionTracker;","map":{"version":3,"names":["require","AbortController","SubscriptionTracker","_subs","Map","topic","handler","signal","topicSubs","get","find","s","Error","controller","set","concat","addEventListener","unsubscribe","subs","unsubs","filter","forEach","abort","instance","module","exports"],"sources":["C:/Users/User/Documents/clone-starter-kit-08/node_modules/ipfs-http-client/src/pubsub/subscription-tracker.js"],"sourcesContent":["'use strict'\r\n\r\nconst { AbortController } = require('native-abort-controller')\r\n\r\nclass SubscriptionTracker {\r\n  constructor () {\r\n    this._subs = new Map()\r\n  }\r\n\r\n  static singleton () {\r\n    if (SubscriptionTracker.instance) return SubscriptionTracker.instance\r\n    SubscriptionTracker.instance = new SubscriptionTracker()\r\n    return SubscriptionTracker.instance\r\n  }\r\n\r\n  subscribe (topic, handler, signal) {\r\n    const topicSubs = this._subs.get(topic) || []\r\n\r\n    if (topicSubs.find(s => s.handler === handler)) {\r\n      throw new Error(`Already subscribed to ${topic} with this handler`)\r\n    }\r\n\r\n    // Create controller so a call to unsubscribe can cancel the request\r\n    const controller = new AbortController()\r\n\r\n    this._subs.set(topic, [{ handler, controller }].concat(topicSubs))\r\n\r\n    // If there is an external signal, forward the abort event\r\n    if (signal) {\r\n      signal.addEventListener('abort', () => this.unsubscribe(topic, handler))\r\n    }\r\n\r\n    return controller.signal\r\n  }\r\n\r\n  unsubscribe (topic, handler) {\r\n    const subs = this._subs.get(topic) || []\r\n    let unsubs\r\n\r\n    if (handler) {\r\n      this._subs.set(topic, subs.filter(s => s.handler !== handler))\r\n      unsubs = subs.filter(s => s.handler === handler)\r\n    } else {\r\n      this._subs.set(topic, [])\r\n      unsubs = subs\r\n    }\r\n\r\n    unsubs.forEach(s => s.controller.abort())\r\n  }\r\n}\r\n\r\nSubscriptionTracker.instance = null\r\n\r\nmodule.exports = SubscriptionTracker\r\n"],"mappings":"AAAA;;;;;;AAEA,eAA4BA,OAAO,CAAC,yBAAD,CAAnC;AAAA,IAAQC,eAAR,YAAQA,eAAR;;IAEMC,mB;EACJ,+BAAe;IAAA;;IACb,KAAKC,KAAL,GAAa,IAAIC,GAAJ,EAAb;EACD;;;;WAQD,mBAAWC,KAAX,EAAkBC,OAAlB,EAA2BC,MAA3B,EAAmC;MAAA;;MACjC,IAAMC,SAAS,GAAG,KAAKL,KAAL,CAAWM,GAAX,CAAeJ,KAAf,KAAyB,EAA3C;;MAEA,IAAIG,SAAS,CAACE,IAAV,CAAe,UAAAC,CAAC;QAAA,OAAIA,CAAC,CAACL,OAAF,KAAcA,OAAlB;MAAA,CAAhB,CAAJ,EAAgD;QAC9C,MAAM,IAAIM,KAAJ,iCAAmCP,KAAnC,wBAAN;MACD,CALgC,CAOjC;;;MACA,IAAMQ,UAAU,GAAG,IAAIZ,eAAJ,EAAnB;;MAEA,KAAKE,KAAL,CAAWW,GAAX,CAAeT,KAAf,EAAsB,CAAC;QAAEC,OAAO,EAAPA,OAAF;QAAWO,UAAU,EAAVA;MAAX,CAAD,EAA0BE,MAA1B,CAAiCP,SAAjC,CAAtB,EAViC,CAYjC;;;MACA,IAAID,MAAJ,EAAY;QACVA,MAAM,CAACS,gBAAP,CAAwB,OAAxB,EAAiC;UAAA,OAAM,KAAI,CAACC,WAAL,CAAiBZ,KAAjB,EAAwBC,OAAxB,CAAN;QAAA,CAAjC;MACD;;MAED,OAAOO,UAAU,CAACN,MAAlB;IACD;;;WAED,qBAAaF,KAAb,EAAoBC,OAApB,EAA6B;MAC3B,IAAMY,IAAI,GAAG,KAAKf,KAAL,CAAWM,GAAX,CAAeJ,KAAf,KAAyB,EAAtC;MACA,IAAIc,MAAJ;;MAEA,IAAIb,OAAJ,EAAa;QACX,KAAKH,KAAL,CAAWW,GAAX,CAAeT,KAAf,EAAsBa,IAAI,CAACE,MAAL,CAAY,UAAAT,CAAC;UAAA,OAAIA,CAAC,CAACL,OAAF,KAAcA,OAAlB;QAAA,CAAb,CAAtB;;QACAa,MAAM,GAAGD,IAAI,CAACE,MAAL,CAAY,UAAAT,CAAC;UAAA,OAAIA,CAAC,CAACL,OAAF,KAAcA,OAAlB;QAAA,CAAb,CAAT;MACD,CAHD,MAGO;QACL,KAAKH,KAAL,CAAWW,GAAX,CAAeT,KAAf,EAAsB,EAAtB;;QACAc,MAAM,GAAGD,IAAT;MACD;;MAEDC,MAAM,CAACE,OAAP,CAAe,UAAAV,CAAC;QAAA,OAAIA,CAAC,CAACE,UAAF,CAAaS,KAAb,EAAJ;MAAA,CAAhB;IACD;;;WAvCD,qBAAoB;MAClB,IAAIpB,mBAAmB,CAACqB,QAAxB,EAAkC,OAAOrB,mBAAmB,CAACqB,QAA3B;MAClCrB,mBAAmB,CAACqB,QAApB,GAA+B,IAAIrB,mBAAJ,EAA/B;MACA,OAAOA,mBAAmB,CAACqB,QAA3B;IACD;;;;;;AAsCHrB,mBAAmB,CAACqB,QAApB,GAA+B,IAA/B;AAEAC,MAAM,CAACC,OAAP,GAAiBvB,mBAAjB"},"metadata":{},"sourceType":"script"}